(function($){var console=window.console||{};console.error=window.console.error||function(){};window.fg=function(fgObj){var self={};var varPrivate={};self.properties={ssl:'http',env:'api',apiBase:'.fairgarage.de/smp/api/',languageCode:'de',countryCode:'DE'};self.setProperties=function(newProperties){$.extend(self.properties,newProperties);};self.setProperties(fgObj);self.getProperty=function(propertyName){return self.properties[propertyName];};self.removeProperties=function(properties){$.each(properties,function(){delete self.properties[this.toString()];});};self.api=function(obj){var functionName=obj.functionName||'api()';var type=obj.type||'GET';var urlParam=obj.urlParam||{};var url=(($.inArray(self.getProperty('ssl'),['http','https'])>=0)?self.getProperty('ssl'):'http')+'://'+self.getProperty('env')+self.getProperty('apiBase')+(obj.apiUrl||'authentication/login')+(varPrivate.sessionId?';jsessionid='+varPrivate.sessionId:'')+('?'+$.param($.extend({contextKey:self.getProperty('contextKey')},urlParam)));var error=obj.error||function(jqXHR,textStatus,errorThrown){try{var errMsg=[];$.each(jqXHR.responseJSON,function(){var temp;if(this.field){temp=this.field.split('.')[1]||this.field.split('.')[0]+' of the payload'+(this.errorMessage?', '+this.errorMessage:' error');}else{temp=this.errorMessage;}
errMsg.push(temp);});self.error('Network Error: '+textStatus+', '+errorThrown+'. '+errMsg.join('; '));}catch(err){self.error('Error in FairGarage API when trying to use function '+functionName);}};var ajaxObj={crossDomain:true,type:type,async:obj.async||true,cache:obj.cache||false,url:url,contentType:obj.contentType||'application/json;charset=UTF-8',dataType:obj.dataType||'json',data:obj.data||'',error:error};ajaxObj=$.extend(obj,ajaxObj);$.ajax(ajaxObj);};self.error=function(str){console.error(str);};self.getFirstDateInConstructionTimeMap=function(constructionTimeMap){var years=[];for(var year in constructionTimeMap){years.push(year);}
var thisYear=years.sort()[0];return(thisYear+'-'+('0'+constructionTimeMap[thisYear].sort(function(a,b){return a-b;})[0]).slice(-2)+'-01');};self.dateToTimestamp=function(date){if(!(/\d{4}\-\d{2}\-01/.test(date)||/\d{4}\-\d{1}\-01/.test(date))){return self.error('Please write the date in the format YYYY-MM-01, e.g. "2008-01-01"');}
var year=date.split('-')[0];var month=parseInt(date.split('-')[1])-1;return(new Date(year,month)).getTime();};self.timestampToDate=function(timestamp){var time=new Date(timestamp);var year=time.getFullYear();var month=time.getMonth()+1;var date=year+'-'+('0'+month).slice(-2)+'-01';return date;};self.getBookingVersion=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var bookedOfferKey=pobj.bookedOfferKey;if(typeof bookedOfferKey=='undefined'){paramMissingHint.push('"bookedOfferKey" of type "string"');bookedOfferKey='';}
if(paramMissingHint.length>0){self.error('Please indicate in function getBookingVersion(): '+paramMissingHint.join(', '));return;}
var obj={apiUrl:'bookings/'+bookedOfferKey+'/version',functionName:'getBookingVersion()'};self.api($.extend(obj,ajax));};self.getLocation=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var locationId=typeof pobj.locationId!=='undefined'?pobj.locationId:self.getProperty('locationId');if(typeof locationId=='undefined'){paramMissingHint.push('"locationId" of type "string"');locationId='';}
if(paramMissingHint.length>0){self.error('Please indicate in function getLocation(): '+paramMissingHint.join(', '));return;}
var obj={apiUrl:'locations/'+locationId,functionName:'getLocation()'};self.api($.extend(obj,ajax));};self.getOffer=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var offerKey=pobj.offerKey;if(typeof offerKey=='undefined'){paramMissingHint.push('"offerKey" of type "string"');offerKey='';}
var criteria=pobj.criteria;if(paramMissingHint.length>0){self.error('Please indicate in function getOffer(): '+paramMissingHint.join(', '));return;}
var obj={apiUrl:'offers/'+offerKey,urlParam:criteria,functionName:'getOffer()'};self.api($.extend(obj,ajax));};self.getOfferList=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var offerSearchKey=pobj.offerSearchKey;if(typeof offerSearchKey=='undefined'){paramMissingHint.push('"offerSearchKey" of type "string"');offerSearchKey='';}
var criteria=pobj.criteria;if(paramMissingHint.length>0){self.error('Please indicate in function getOfferList(): '+paramMissingHint.join(', '));return;}
var obj={apiUrl:'offers/list/'+offerSearchKey,urlParam:criteria,functionName:'getOfferList()'};self.api($.extend(obj,ajax));};self.createOfferSearch=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var offerSearch=pobj.offerSearch;if(typeof offerSearch=='undefined'){paramMissingHint.push('"offerSearch" of type "object"');offerSearch={};}
if(typeof offerSearch.selectedVehicle=='undefined'){paramMissingHint.push('"selectedVehicle" of type "object" in "offerSearch"');}
if(typeof offerSearch.selectedServiceList=='undefined'){paramMissingHint.push('"selectedServiceList" of type "array of objects" in "offerSearch"');}
var criteria=pobj.criteria;if(paramMissingHint.length>0){self.error('Please indicate in function createOfferSearch(): '+paramMissingHint.join(', '));return;}
var obj={type:'POST',apiUrl:'offersearches',urlParam:criteria,data:JSON.stringify(offerSearch),functionName:'createOfferSearch()'};self.api($.extend(obj,ajax));};self.getOfferSearch=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var offerSearchKey=pobj.offerSearchKey;if(typeof offerSearchKey=='undefined'){paramMissingHint.push('"offerSearchKey" of type "string"');offerSearchKey='';}
if(paramMissingHint.length>0){self.error('Please indicate in function getOfferSearch(): '+paramMissingHint.join(', '));return;}
var obj={type:'GET',apiUrl:'offersearches/'+offerSearchKey,functionName:'getOfferSearch()'};self.api($.extend(obj,ajax));};self.getServiceById=function(pobj){if(typeof pobj=='undefined'){pobj={};}
var paramMissingHint=[];var ajax=pobj.ajax||{};var serviceId=pobj.serviceId;if(typeof serviceId=='undefined'){paramMissingHint.push('"serviceId" of type "string"');serviceId='';}
var criteria=pobj.criteria;if(paramMissingHint.length>0){self.error('Please indicate in function getServiceById(): '+paramMissingHint.join(', '));return;}
var obj={apiUrl:'services/services/'+serviceId,urlParam:criteria,functionName:'getServiceById()'};self.api($.extend(obj,ajax));};return self;};})(jQuery);